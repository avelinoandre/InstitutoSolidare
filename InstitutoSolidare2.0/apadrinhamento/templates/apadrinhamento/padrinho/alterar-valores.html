{% extends "shared/base_logout.html" %}
{% load static %}
{%  block content %}
<div style="background-color: #9ec9f0; padding: 40px; min-height: 100vh;">
    <div style="background-color: #d9d9d9; border-radius: 20px; padding: 30px;">

        <div id="perguntas-container" style="display: flex; flex-direction: column; gap: 30px;">
            {% for pergunta in perguntas %}
            <div>
                <div>{{ pergunta.pergunta }}</div>

                <select id="resposta-{{ forloop.counter0 }}">
                    {% for opcao in pergunta.respostas %}
                        <option value="{{ forloop.counter0 }}">{{ opcao }}</option>
                    {% endfor %}
                </select>
            </div>
            {% endfor %}
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <button onclick="salvarRespostas()" style="
                background-color: #ffd43b;
                font-weight: bold;
                padding: 12px 24px;
                border: none;
                border-radius: 8px;
                cursor: pointer;
            " onmouseover="this.style.backgroundColor='#e6c237'" onmouseout="this.style.backgroundColor='#ffd43b'">
                SALVAR RESPOSTAS
            </button>
        </div>

        <div id="popup" style="display:none; margin-top: 20px; text-align: center; font-weight: bold;"></div>
    </div>
</div>
<script>
function salvarRespostas() {
    const selects = document.querySelectorAll('[id^="resposta-"]');
    const respostas = [];

    selects.forEach((select, index) => {
        respostas.push(select.value);
    });

    fetch("{% url 'padrinhoAlterarValores' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}",  // garante que o Django aceite o POST
        },
        body: JSON.stringify({ respostas: respostas })
    })
    .then(response => response.json())
    .then(data => {
        const popup = document.getElementById("popup");
        popup.innerText = data.mensagem || "Respostas salvas com sucesso!";
        popup.style.display = "block";
    });
}
</script>
{% include 'partials/circle-button.html' %}
{% endblock %}